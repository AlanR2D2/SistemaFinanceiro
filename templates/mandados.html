{% extends "base.html" %}
{% block title %}Mandados{% endblock %}
{% block header %}Mandados{% endblock %}

{% block content %}
<form class="bg-white rounded-2xl border p-4 mb-4 flex flex-col md:flex-row gap-3 items-end" method="GET" action="/mandados">
  <div class="flex-1">
    <label class="text-xs text-gray-500">Busca (processo/autor/réu)</label>
    <input name="q" value="{{ q }}" class="w-full border rounded-lg px-3 py-2" placeholder="Ex: 5001234 ou Maria">
  </div>
  <div class="w-full md:w-28">
    <label class="text-xs text-gray-500">UF</label>
    <input name="uf" value="{{ uf }}" class="w-full border rounded-lg px-3 py-2" placeholder="RJ">
  </div>
  <div class="w-full md:w-72">
    <label class="text-xs text-gray-500">Status</label>
    <input name="status" value="{{ status }}" class="w-full border rounded-lg px-3 py-2" placeholder="AGUARDANDO PAGAMENTO">
  </div>
  <div class="w-full md:w-44">
    <label class="text-xs text-gray-500">Finalizado</label>
    <select name="finalizado" class="w-full border rounded-lg px-3 py-2">
      <option value="all" {% if finalizado is none %}selected{% endif %}>Todos</option>
      <option value="0" {% if finalizado == 0 %}selected{% endif %}>Abertos</option>
      <option value="1" {% if finalizado == 1 %}selected{% endif %}>Finalizados</option>
    </select>
  </div>
  <button class="px-4 py-2 rounded-lg bg-gray-900 text-white hover:bg-black">Filtrar</button>
</form>

<div class="bg-white rounded-2xl border overflow-hidden">
  <div class="p-4 border-b flex items-center justify-between">
    <div class="font-semibold text-gray-800">Registros ({{ rows|length }})</div>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full text-sm">
      <thead class="bg-gray-50 text-gray-600">
        <tr>
          <th class="text-left px-4 py-3">Data Quitação</th>
          <th class="text-left px-4 py-3">Processo</th>
          <th class="text-left px-4 py-3">UF</th>
          <th class="text-left px-4 py-3">Réu</th>
          <th class="text-left px-4 py-3">Autor</th>
          <th class="text-left px-4 py-3">Quitação</th>
          <th class="text-left px-4 py-3">Status</th>
          <th class="text-left px-4 py-3">Mês</th>
          <th class="text-left px-4 py-3">Finalizado</th>
        </tr>
      </thead>
      <tbody class="divide-y">
        {% for r in rows %}
        <tr class="hover:bg-gray-50">
          <td class="px-4 py-3">{{ r.data_quitacao }}</td>
          <td class="px-4 py-3 font-medium text-gray-800">{{ r.numero_processo }}</td>
          <td class="px-4 py-3">{{ r.uf }}</td>
          <td class="px-4 py-3">{{ r.reu }}</td>
          <td class="px-4 py-3">{{ r.autor }}</td>
          <td class="px-4 py-3">{{ r.quitacao }}</td>
          <td class="px-4 py-3">{{ r.status }}</td>
          <td class="px-4 py-3">{{ r.mes_pg }}</td>
          <td class="px-4 py-3">
            {% if r.finalizado == 1 %}
              <span class="px-2 py-1 rounded-full text-xs bg-green-100 text-green-700">Sim</span>
            {% else %}
              <span class="px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-700">Não</span>
            {% endif %}
          </td>
          
        </tr>
        {% endfor %}
        {% if rows|length == 0 %}
        <tr><td class="px-4 py-6 text-gray-500" colspan="9">Nenhum registro encontrado.</td></tr>
        {% endif %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
